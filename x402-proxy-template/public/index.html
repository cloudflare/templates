<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>x402 Payment-Gated Proxy</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
			rel="stylesheet"
		/>
		<style>
			:root {
				--color-primary: #f97316;
				--color-text: #c2410c;
				--color-bg: #ffffff;
				--color-hover: #fff7ed;
				--color-dark: #7c2d12;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: "Inter", sans-serif;
				background-color: var(--color-bg);
				background-image: radial-gradient(
					circle,
					rgba(249, 115, 22, 0.4) 1px,
					transparent 1px
				);
				background-size: 24px 24px;
				color: var(--color-text);
				min-height: 100vh;
			}

			/* Main Container */
			.main-container {
				max-width: 1400px;
				margin: 0 auto;
				border: 1px solid var(--color-primary);
				min-height: 100vh;
				margin-top: 40px;
				margin-bottom: 40px;
				background: var(--color-bg);
			}

			.btn-primary {
				background: var(--color-primary);
				color: white;
				padding: 0.75rem 1.5rem;
				border-radius: 9999px;
				text-decoration: none;
				font-weight: 600;
				font-size: 0.95rem;
				transition: background 0.2s;
			}

			.btn-primary:hover {
				background: var(--color-dark);
			}

			.btn-outline {
				background: transparent;
				color: var(--color-primary);
				padding: 0.75rem 1.5rem;
				border-radius: 9999px;
				text-decoration: none;
				font-weight: 600;
				font-size: 0.95rem;
				border: 2px solid var(--color-primary);
				transition: all 0.2s;
			}

			.btn-outline:hover {
				background: var(--color-hover);
			}

			/* Hero Section */
			.hero {
				padding: 6rem 2rem;
				text-align: center;
				border-bottom: 1px solid var(--color-primary);
			}

			.hero-icon {
				width: 120px;
				height: 120px;
				margin: 0 auto 2rem;
			}

			.hero h1 {
				font-size: clamp(2.5rem, 8vw, 4.5rem);
				font-weight: 800;
				letter-spacing: -0.04em;
				line-height: 1.1;
				margin-bottom: 1.5rem;
				color: var(--color-dark);
			}

			.hero h1 span {
				color: var(--color-primary);
			}

			.hero p {
				font-size: 1.25rem;
				max-width: 650px;
				margin: 0 auto 2.5rem;
				line-height: 1.6;
				color: var(--color-text);
			}

			.hero-buttons {
				display: flex;
				gap: 1rem;
				justify-content: center;
				flex-wrap: wrap;
			}

			.code-badge {
				display: inline-block;
				background: var(--color-hover);
				border: 1px solid var(--color-primary);
				padding: 0.5rem 1rem;
				border-radius: 0.5rem;
				font-family: monospace;
				font-size: 0.9rem;
				margin-top: 2rem;
			}

			/* Feature Grid */
			.feature-grid {
				display: grid;
				grid-template-columns: 35% 65%;
				min-height: 600px;
			}

			.feature-list {
				border-right: 1px solid var(--color-primary);
			}

			.feature-list h2 {
				padding: 2rem;
				font-size: 1.5rem;
				font-weight: 700;
				letter-spacing: -0.02em;
				border-bottom: 1px solid var(--color-primary);
			}

			.feature-item {
				padding: 1.5rem 2rem;
				border-bottom: 1px solid var(--color-primary);
				display: flex;
				gap: 1rem;
				align-items: flex-start;
				transition: background 0.2s;
				cursor: default;
			}

			.feature-item:hover {
				background: var(--color-hover);
			}

			.feature-number {
				font-weight: 700;
				font-size: 1.25rem;
				color: var(--color-primary);
				min-width: 2rem;
			}

			.feature-content h3 {
				font-size: 1.1rem;
				font-weight: 600;
				margin-bottom: 0.5rem;
			}

			.feature-content p {
				font-size: 0.9rem;
				line-height: 1.5;
				opacity: 0.9;
			}

			.feature-content code {
				background: var(--color-hover);
				padding: 0.15rem 0.4rem;
				border-radius: 0.25rem;
				font-size: 0.85rem;
			}

			/* Diagram Section */
			.diagram-section {
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 3rem;
				position: relative;
			}

			.diagram-svg {
				width: 100%;
				max-width: 500px;
				height: auto;
			}

			/* Test Endpoints Section */
			.test-section {
				border-top: 1px solid var(--color-primary);
				padding: 3rem 2rem;
			}

			.test-section h2 {
				font-size: 1.5rem;
				font-weight: 700;
				letter-spacing: -0.02em;
				margin-bottom: 2rem;
				text-align: center;
			}

			.endpoint-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 1.5rem;
				max-width: 800px;
				margin: 0 auto;
			}

			.endpoint-card {
				border: 1px solid var(--color-primary);
				border-radius: 8px;
				padding: 1.5rem;
				transition: background 0.2s;
			}

			.endpoint-card:hover {
				background: var(--color-hover);
			}

			.endpoint-card h3 {
				font-size: 1rem;
				font-weight: 600;
				margin-bottom: 0.5rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.endpoint-card .method {
				background: var(--color-primary);
				color: white;
				padding: 0.2rem 0.5rem;
				border-radius: 4px;
				font-size: 0.75rem;
				font-weight: 700;
			}

			.endpoint-card .path {
				font-family: monospace;
				background: var(--color-hover);
				padding: 0.5rem;
				border-radius: 4px;
				margin-bottom: 0.75rem;
				font-size: 0.9rem;
			}

			.endpoint-card p {
				font-size: 0.85rem;
				line-height: 1.5;
			}

			.endpoint-card .status {
				display: inline-block;
				margin-top: 0.75rem;
				font-size: 0.8rem;
				font-weight: 600;
			}

			.endpoint-card .status.public {
				color: #16a34a;
			}

			.endpoint-card .status.protected {
				color: var(--color-primary);
			}

			/* Footer */
			footer {
				border-top: 1px solid var(--color-primary);
				padding: 2rem;
				text-align: center;
				font-size: 0.9rem;
			}

			footer a {
				color: var(--color-primary);
				text-decoration: none;
			}

			footer a:hover {
				text-decoration: underline;
			}

			/* Responsive */
			@media (max-width: 768px) {
				.feature-grid {
					grid-template-columns: 1fr;
				}

				.feature-list {
					border-right: none;
					border-bottom: 1px solid var(--color-primary);
				}

				.hero {
					padding: 4rem 1.5rem;
				}

				.main-container {
					margin: 40px 10px;
				}
			}
		</style>
	</head>
	<body>
		<!-- Main Container -->
		<div class="main-container">
			<!-- Hero Section -->
			<section class="hero">
				<img src="/x402-icon.svg" alt="x402 Icon" class="hero-icon" />
				<h1>Payment-Gated<br /><span>Reverse Proxy</span></h1>
				<p>
					A Cloudflare Worker that sits in front of any backend and gates access
					to protected routes with USDC payments. Zero backend modifications
					required.
				</p>
				<div class="hero-buttons">
					<a href="/__x402/protected" class="btn-primary"
						>Try Protected Route</a
					>
					<a
						href="https://developers.cloudflare.com/agents/x402/"
						class="btn-outline"
						>View Documentation</a
					>
				</div>
				<div class="code-badge">/__x402/health &bull; /__x402/protected</div>
			</section>

			<!-- Feature Grid -->
			<section class="feature-grid">
				<div class="feature-list">
					<h2>Template Features</h2>
					<div class="feature-item">
						<span class="feature-number">01</span>
						<div class="feature-content">
							<h3>Transparent Proxying</h3>
							<p>
								All non-protected requests pass through unchanged to your origin
								server. Your backend stays untouched.
							</p>
						</div>
					</div>
					<div class="feature-item">
						<span class="feature-number">02</span>
						<div class="feature-content">
							<h3>Pattern-Based Protection</h3>
							<p>
								Configure routes with exact paths like <code>/premium</code> or
								wildcards like <code>/api/private/*</code>.
							</p>
						</div>
					</div>
					<div class="feature-item">
						<span class="feature-number">03</span>
						<div class="feature-content">
							<h3>JWT Session Caching</h3>
							<p>
								After payment, a secure HttpOnly cookie grants 1-hour access
								without additional payments.
							</p>
						</div>
					</div>
					<div class="feature-item">
						<span class="feature-number">04</span>
						<div class="feature-content">
							<h3>Configurable Pricing</h3>
							<p>
								Set custom USDC prices per route. Works on Base Sepolia
								(testnet) or Base mainnet.
							</p>
						</div>
					</div>
					<div class="feature-item">
						<span class="feature-number">05</span>
						<div class="feature-content">
							<h3>Edge-Native</h3>
							<p>
								Runs entirely on Cloudflare Workers. Stateless design with no
								server-side session storage.
							</p>
						</div>
					</div>
				</div>
				<div class="diagram-section">
					<svg
						class="diagram-svg"
						viewBox="0 0 440 380"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
					>
						<!-- Client Node -->
						<rect
							x="140"
							y="20"
							width="120"
							height="50"
							rx="8"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<text
							x="200"
							y="50"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="Inter, sans-serif"
							font-weight="600"
							font-size="14"
						>
							Client
						</text>

						<!-- x402 Proxy Node -->
						<rect
							x="120"
							y="150"
							width="160"
							height="60"
							rx="8"
							stroke="var(--color-primary)"
							stroke-width="2"
							fill="var(--color-hover)"
						/>
						<text
							x="200"
							y="175"
							text-anchor="middle"
							fill="var(--color-dark)"
							font-family="Inter, sans-serif"
							font-weight="700"
							font-size="14"
						>
							x402 Proxy
						</text>
						<text
							x="200"
							y="195"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="Inter, sans-serif"
							font-weight="400"
							font-size="10"
						>
							(This Template)
						</text>

						<!-- Origin Server Node -->
						<rect
							x="140"
							y="300"
							width="120"
							height="50"
							rx="8"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<text
							x="200"
							y="330"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="Inter, sans-serif"
							font-weight="600"
							font-size="14"
						>
							Origin Server
						</text>

						<!-- Facilitator Node -->
						<rect
							x="335"
							y="155"
							width="90"
							height="50"
							rx="8"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<text
							x="380"
							y="183"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="Inter, sans-serif"
							font-weight="600"
							font-size="11"
						>
							Facilitator
						</text>

						<!-- Connection Lines -->
						<!-- Client to Proxy - Request -->
						<line
							x1="175"
							y1="70"
							x2="175"
							y2="150"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<polygon
							points="175,150 170,140 180,140"
							fill="var(--color-primary)"
						/>
						<text
							x="125"
							y="110"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="9"
						>
							GET /api/*
						</text>

						<!-- Proxy to Client - 402 -->
						<line
							x1="225"
							y1="150"
							x2="225"
							y2="70"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<polygon
							points="225,70 220,80 230,80"
							fill="var(--color-primary)"
						/>
						<text
							x="235"
							y="100"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="9"
						>
							402
						</text>
						<text
							x="235"
							y="115"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="8"
						>
							or 200
						</text>

						<!-- Proxy to Origin -->
						<line
							x1="175"
							y1="210"
							x2="175"
							y2="300"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<polygon
							points="175,300 170,290 180,290"
							fill="var(--color-primary)"
						/>
						<text
							x="125"
							y="255"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="9"
						>
							Forward
						</text>

						<!-- Origin to Proxy -->
						<line
							x1="225"
							y1="300"
							x2="225"
							y2="210"
							stroke="var(--color-primary)"
							stroke-width="2"
						/>
						<polygon
							points="225,210 220,220 230,220"
							fill="var(--color-primary)"
						/>
						<text
							x="235"
							y="255"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="9"
						>
							Response
						</text>

						<!-- Proxy to Facilitator -->
						<line
							x1="280"
							y1="180"
							x2="335"
							y2="180"
							stroke="var(--color-primary)"
							stroke-width="2"
							stroke-dasharray="4"
						/>
						<polygon
							points="335,180 325,175 325,185"
							fill="var(--color-primary)"
						/>
						<text
							x="300"
							y="170"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="8"
						>
							verify
						</text>

						<!-- Cookie Icon -->
						<rect
							x="20"
							y="160"
							width="70"
							height="40"
							rx="6"
							stroke="var(--color-primary)"
							stroke-width="1.5"
							fill="var(--color-hover)"
						/>
						<text
							x="55"
							y="177"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="8"
						>
							JWT
						</text>
						<text
							x="55"
							y="190"
							text-anchor="middle"
							fill="var(--color-text)"
							font-family="monospace"
							font-size="8"
						>
							Cookie
						</text>
						<line
							x1="90"
							y1="180"
							x2="120"
							y2="180"
							stroke="var(--color-primary)"
							stroke-width="1.5"
							stroke-dasharray="4"
						/>
					</svg>
				</div>
			</section>

			<!-- Test Endpoints Section -->
			<section class="test-section">
				<h2>Built-in Test Endpoints</h2>
				<div class="endpoint-grid">
					<div class="endpoint-card">
						<h3><span class="method">GET</span> Health Check</h3>
						<div class="path">/__x402/health</div>
						<p>
							Public endpoint to verify the proxy is running. Returns JSON with
							status and timestamp.
						</p>
						<span class="status public">Always accessible</span>
					</div>
					<div class="endpoint-card">
						<h3><span class="method">GET</span> Protected Test</h3>
						<div class="path">/__x402/protected</div>
						<p>
							Test payment flow without an origin server. Requires valid payment
							or session cookie to access.
						</p>
						<span class="status protected">Requires payment</span>
					</div>
				</div>
			</section>

			<!-- Footer -->
			<footer>
				<p>
					Built with
					<a href="https://workers.cloudflare.com">Cloudflare Workers</a> &bull;
					<a href="https://developers.cloudflare.com/agents/x402/">x402 Docs</a>
					&bull;
					<a href="https://www.x402.org/">x402 Protocol</a>
				</p>
			</footer>
		</div>
	</body>
</html>
